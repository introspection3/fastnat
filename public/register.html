<!DOCTYPE html>
<html>

<head>
    <title>FastNat注册</title>
    <script type="text/javascript" src="/js/jquery.min.js"></script>
    <script type="text/javascript" src="/w2ui/w2ui.min.js"></script>
    <script type="text/javascript" src="/w2ui/w2uiSettings.js"></script>
    <link rel="stylesheet" type="text/css" href="/w2ui/w2ui.min.css" />
</head>

<body>

    <div id="form" style="width: 750px;"></div>



    <script type="text/javascript">
        function refreshCode(e) {
            $(e).attr('src', '/user/vcode?_=' + Math.random());
        }
        $(function() {
            w2popup.message({
                width: 200,
                height: 60,
                html: '<div class="w2ui-centered"><div style="padding: 10px;">' +
                    '		message ' +
                    '</div></div>'
            });
            $('#imgCode').click(function() {
                console.log('aaa')
                $('#imgCode').attr('src', '/user/vcode?_=' + Math.random());
            });
            $('#form').w2form({
                name: 'form',
                header: 'FastNat注册',
                focus: 'username',
                url: 'user/register',
                record: {

                },
                fields: [{
                        field: 'username',
                        type: 'text',
                        required: true,
                        html: {
                            label: '用户名',
                            attr: 'style="width: 200px" maxlength="20" size="60"'
                        }
                    }, {
                        field: 'password',
                        type: 'password',

                        required: true,
                        html: {
                            label: '密码',
                            attr: 'style="width: 200px" maxlength="150" size="60"'
                        }
                    }, {
                        field: 'email',
                        type: 'email',
                        required: true,
                        html: {
                            label: '邮箱',
                            attr: 'style="width: 200px" maxlength="150" size="60"'
                        }
                    },

                    {
                        field: 'img',
                        type: 'html',
                        html: {
                            label: '验证码:',
                            html: '<div><img style="width: 100px; cursor:pointer" onclick="refreshCode(this)" src="/user/vcode" alt="点击刷新"/></div>'
                        }
                    }, {
                        field: 'vcode',
                        type: 'text',
                        required: true,
                        html: {
                            label: '',
                            attr: 'style="width: 200px" maxlength="4" '
                        }
                    }, {
                        field: 'telphone',
                        type: 'text',
                        required: true,
                        html: {
                            label: '电话',
                            attr: 'style="width: 200px" maxlength="15" '
                        }
                    }
                ],
                actions: {
                    reset: function() {
                        console.log(w2ui['form'].validate());
                        this.clear();
                    },
                    save: function() {
                        this.save();
                    }
                },
                onSave: function(event) {
                    let result = event.data;
                    if (result.success) {
                        w2popup.message({
                            width: 400,
                            height: 180,
                            html: '<div style="padding: 60px; text-align: center">Click on the message to Hide it</div>' +
                                '<div style="text-align: center"><button class="w2ui-btn" onclick="w2popup.message()">Close</button>'
                        });
                    } else {
                        w2popup.message({
                            width: 400,
                            height: 180,
                            html: '<div style="padding: 60px; text-align: center">Click on the message to Hide it</div>' +
                                '<div style="text-align: center"><button class="w2ui-btn" onclick="w2popup.message()">Close</button>'
                        });
                    }
                }
            });
        });
    </script>

</body>

</html>